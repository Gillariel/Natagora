<ui:composition template="/WEB-INF/template/layout.xhtml"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

    <ui:define name="title">
        Dashboard
    </ui:define>

    <ui:define name="css">

    </ui:define>

    <ui:define name="content">
        <div class="row">
            <div class="col-lg-3"></div>
            <div class="col-lg-6">
                <div class="white-box">
                    <h3 class="box-title">New users for this month</h3>
                    <div>
                        <canvas id="chart4" data-all="#{statisticHandler.users()}" data-number="#{statisticHandler.lastUsers()}" width="400" height="100"> </canvas>
                    </div>
                </div>
            </div>
            <div class="col-lg-3"></div>
        </div>
        
        <div class="row">
            <div class="col-lg-6 col-sm-12 col-xs-12">
                <div class="row">
                    <div class="col-lg-6 col-sm-6 col-xs-12">
                        <div class="white-box">
                            <h3 class="box-title">media in pending</h3>
                            <ul class="list-inline m-t-30 p-t-10 two-part">
                                <li><i class="icon-folder text-warning"></i></li>
                                <li class="text-right"><span class="counter">#{pendingHandler.all().size()}</span></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-lg-6 col-sm-6 col-xs-12">
                        <div class="white-box">
                            <h3 class="box-title">comments reported</h3>
                            <ul class="list-inline m-t-30 p-t-10 two-part">
                                <li><i class="icon-dislike text-danger"></i></li>
                                <li class="text-right"><span class="counter">#{reportedHandler.countReported()}</span></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-lg-6 col-sm-6 col-xs-12">
                        <div class="white-box">
                            <h3 class="box-title">Number of Observations</h3>
                            <ul class="list-inline m-t-30 p-t-10 two-part">
                                <li><i class="icon-people text-info"></i></li>
                                <li class="text-right"><span class="">#{statisticHandler.observations()}</span></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-lg-6 col-sm-6 col-xs-12">
                        <div class="white-box">
                            <h3 class="box-title">birds known</h3>
                            <ul class="list-inline m-t-30 p-t-10 two-part">
                                <li><i class="fa fa-paw text-success"></i></li>
                                <li class="text-right"><span class="">#{statisticHandler.birds()}</span></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-md-12 col-lg-12 col-sm-12">
                        <div class="white-box bg-extralight m-b-0">
                            <h3 class="box-title">Apps Availibity</h3>
                        </div>
                        <div class="white-box p-b-0">
                            <div class="row">
                                <div class="col-xs-12">
                                    <a href="/NatAdmin/server/overview.xhtml"><h2 class="text-muted m-t-0">Make a complete test</h2></a>
                                </div>
                            </div>
                            <div class="row m-t-30 minus-margin">
                                <div class="col-sm-12 col-sm-6 b-t b-r">
                                    <ul class="expense-box">
                                        <li>
                                            <c:choose>
                                                <c:when test="#{networkHandler.pingNatAdmin()}">
                                                    <i class="fa fa-lock text-success"></i><span><h2>NatAdmin</h2><h4><i class="fa fa-check-circle-o text-success"></i></h4></span>
                                                </c:when>
                                                <c:otherwise>
                                                    <i class="fa fa-lock text-danger"></i><span><h2>NatAdmin</h2><h4><i class="fa fa-check-circle-o text-danger"></i></h4></span>
                                                </c:otherwise>
                                            </c:choose>
                                        </li>
                                    </ul>
                                </div>
                                <div class="col-sm-12 col-sm-6  b-t">
                                    <ul class="expense-box">
                                        <li>
                                            <c:choose>
                                                <c:when test="#{networkHandler.pingNataMobile()}">
                                                    <i class="fa ti-android text-success"></i><span><h2>NataMobile</h2><h4><i class="fa fa-check-circle-o text-success"></i></h4></span>
                                                </c:when>
                                                <c:otherwise>
                                                    <i class="fa ti-android text-danger"></i><span><h2>NataMobile</h2><h4><i class="fa fa-check-circle-o text-danger"></i></h4></span>
                                                </c:otherwise>
                                            </c:choose>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="row minus-margin">
                                <div class="col-sm-12 col-sm-6  b-t b-r">
                                    <ul class="expense-box">
                                        <li>
                                            <c:choose>
                                                <c:when test="#{networkHandler.pingNataRest()}">
                                                    <i class="fa fa-server text-success"></i><span><h2>NataRest</h2><h4><i class="fa fa-check-circle-o text-success"></i></h4></span>
                                                </c:when>
                                                <c:otherwise>
                                                    <i class="fa fa-server text-danger"></i><span><h2>NataRest</h2><h4><i class="fa fa-check-circle-o text-danger"></i></h4></span>
                                                </c:otherwise>
                                            </c:choose>
                                        </li>
                                    </ul>
                                </div>
                                <div class="col-sm-12 col-sm-6  b-t">
                                    <ul class="expense-box">
                                        <li>
                                            <c:choose>
                                                <c:when test="#{networkHandler.pingNataWeb()}">
                                                    <i class="fa ti-world text-success"></i><span><h2>NataWeb</h2><h4><i class="fa fa-check-circle-o text-success"></i></h4></span>
                                                </c:when>
                                                <c:otherwise>
                                                    <i class="fa ti-world text-danger"></i><span><h2>NataWeb</h2><h4><i class="fa fa-check-circle-o text-danger"></i></h4></span>
                                                </c:otherwise>
                                            </c:choose>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-6 col-md-6 col-sm-12">
                <div class="panel panel-default">
                    <div class="panel-heading">SESSION LAST ACTIVITY</div>
                    <div class="panel-body">
                        <div class="steamline">
                            
                            <!-- Order by Date from db should be better, + top 5 and not all of them -->
                            <c:forEach var="s" items="#{sessionHandler.all()}">
                            
                                <div class="sl-item">
                                    <div class="sl-left bg-success"> <h:graphicImage styleClass="img-circle" alt="user" url="#{s.user.picture}"/></div>
                                    <div class="sl-right">
                                        <div><a href="#">#{s.user.pseudo}</a> <span class="sl-date timeago">#{s.date}</span></div>
                                        <div class="desc">
                                            <!-- Get all media from observations of this sessions and make a gallery like below -->
                                            <c:forEach var="m" items='#{sessionHandler.mediaBySession("1")}'>
                                                <!--<c:choose>
                                                <c:when test=''>-->
                                                    <!--<div class="col-xs-4"><h:graphicImage styleClass="img-responsive" alt="bird" url="#{m.url}"/></div>-->
                                                <!--</c:when>
                                                <c:otherwise>
                                                        <div class="white-box">
                                                            <p style="overflow-wrap: break-word;" class="box-label text-center">#{m.text}</p>
                                                            <br />
                                                        </div>
                                                    </c:otherwise>
                                                </c:choose>-->
                                            </c:forEach>
                                        </div>
                                    </div>
                                </div>
                                
                            </c:forEach>
                                
                            <div class="sl-item">
                                <div class="sl-left bg-info"><i class="fa fa-image"></i></div>
                                <div class="sl-right">
                                    <div><a href="#">Hritik Roshan</a> <span class="sl-date timeago">18-10-2017 02:37:54</span></div>
                                    <div class="desc">Lorem Ipsum is simply dummy</div>
                                    <div class="row inline-photos">
                                        <div class="col-xs-4"><h:graphicImage styleClass="img-responsive" alt="bird" name="img/birds/1.jpg"/></div>
                                        <div class="col-xs-4"><h:graphicImage styleClass="img-responsive" alt="bird" name="img/birds/2.jpg"/></div>
                                        <div class="col-xs-4"><h:graphicImage styleClass="img-responsive" alt="bird" name="img/birds/3.jpg"/></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </ui:define>

    <ui:define name="js">
        <h:outputScript name="plugins/bower_components/counterup/jquery.counterup.min.js"/>
        <h:outputScript name="plugins/bower_components/Chart.js/chartjs.init.js"/>
        <h:outputScript name="plugins/bower_components/Chart.js/Chart.min.js"/>
        
        <h:outputScript name="ample/js/timeAgo.js" />
        
        <script>
            $(document).ready(function(){
                $(".timeago").each(function() {
                    var date = $(this).text();
                    var dateAndTime = date.split(" ");
                    var splittedDate = dateAndTime[0].split("-");
                    $(this).text($.timeago(splittedDate[2] + "-" + splittedDate[1] + "-" + splittedDate[0] + " " + dateAndTime[1]));
                });
            });
        </script>
    </ui:define>

</ui:composition>

